"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const csharp_1 = require("csharp");
const ViewTools_1 = require("./framework/components/ViewTools");
const GlobalData_1 = require("./framework/utils/GlobalData");
const LogsManager_1 = require("./framework/manager/LogsManager");
const MainModule_1 = require("./framework/manager/MainModule");
const PackConfigManager_1 = require("./framework/manager/PackConfigManager");
const FileUtils_1 = require("./framework/utils/FileUtils");
const EngineExpand_1 = require("./framework/engine/EngineExpand");
const FrameWorkHandle_1 = require("./game/sys/manager/FrameWorkHandle");
const BaseFunc_1 = require("./framework/func/BaseFunc");
const UserInfo_1 = require("./framework/common/UserInfo");
const TimerManager_1 = require("./framework/manager/TimerManager");
const ScreenAdapterTools_1 = require("./framework/utils/ScreenAdapterTools");
class Main {
    constructor() {
        if (!global.window) {
            //赋值global.window 为global. 兼容web标准 .
            global.window = global;
        }
        var thisObj = this;
        global.initGame = function (stageRoot, uiRoot) {
            thisObj.initWindowEnv();
            TimerManager_1.default.instance.setTimeout(thisObj.delayEnterGame, thisObj, 10, stageRoot, uiRoot);
        };
        this.showMainModule();
    }
    delayEnterGame(stageRoot, uiRoot) {
        GlobalData_1.default.initStage(stageRoot, uiRoot);
        ViewTools_1.default.init();
        BaseFunc_1.default.setCfgExportType(BaseFunc_1.default.exportType_New);
        var size = GlobalData_1.default.uiRoot.getViewRect();
        LogsManager_1.default.echo("ScreenSize:", csharp_1.UnityEngine.Screen.width, csharp_1.UnityEngine.Screen.height);
        ScreenAdapterTools_1.default.checkScreenFixMode(size.x, size.y);
        ScreenAdapterTools_1.default.screenWidth = csharp_1.UnityEngine.Screen.width;
        ScreenAdapterTools_1.default.screenHeight = csharp_1.UnityEngine.Screen.height;
        // //初始化全局变量
        FrameWorkHandle_1.default.init();
        //
        PackConfigManager_1.default.initCfgs();
        UserInfo_1.default.init();
        if (UserInfo_1.default.isSystemIos()) {
            UserInfo_1.default.adMediaType = UserInfo_1.PlatformIdType.adMedia_gdt;
        }
        FileUtils_1.default.initRootCachePath();
        //初始化引擎扩展
        EngineExpand_1.default.initEngineExpand();
        UserInfo_1.default.platform.setSystemInfo();
        new MainModule_1.default();
    }
    showMainModule() {
    }
    /**打点-激活数据上传到阿里云 */
    checkIsNew() {
    }
    //初始化全局变量
    initWindowEnv() {
        if (!window["LogsManager"]) {
            window["LogsManager"] = LogsManager_1.default;
        }
        if (!window["UserInfo"]) {
            window["UserInfo"] = UserInfo_1.default;
        }
        //赋值timemanager
        window["TimerManager"] = TimerManager_1.default;
        window["GlobalData"] = GlobalData_1.default;
    }
}
//激活启动类
new Main();
//# sourceMappingURL=Main.js.map