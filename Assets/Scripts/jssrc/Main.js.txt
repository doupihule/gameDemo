"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ViewTools_1 = require("./framework/components/ViewTools");
const GlobalData_1 = require("./framework/utils/GlobalData");
const LogsManager_1 = require("./framework/manager/LogsManager");
const MainModule_1 = require("./framework/manager/MainModule");
const PackConfigManager_1 = require("./framework/manager/PackConfigManager");
const FileUtils_1 = require("./framework/utils/FileUtils");
const EngineExpand_1 = require("./framework/engine/EngineExpand");
const FrameWorkHandle_1 = require("./game/sys/manager/FrameWorkHandle");
const BaseFunc_1 = require("./framework/func/BaseFunc");
const UserInfo_1 = require("./framework/common/UserInfo");
const TimerManager_1 = require("./framework/manager/TimerManager");
const ScreenAdapterTools_1 = require("./framework/utils/ScreenAdapterTools");
class Main {
    constructor() {
        if (!global.window) {
            //赋值global.window 为global. 兼容web标准 .
            global.window = global;
        }
        var thisObj = this;
        global.initGame = function (stageRoot, uiRoot) {
            GlobalData_1.default.initStage(stageRoot, uiRoot);
            ViewTools_1.default.init();
            BaseFunc_1.default.setCfgExportType(BaseFunc_1.default.exportType_New);
            var size = GlobalData_1.default.uiRoot.getViewRect();
            ScreenAdapterTools_1.default.checkScreenFixMode(size.x, size.y);
            // //初始化全局变量
            thisObj.initWindowEnv();
            FrameWorkHandle_1.default.init();
            //
            PackConfigManager_1.default.initCfgs();
            UserInfo_1.default.init();
            if (UserInfo_1.default.isSystemIos()) {
                UserInfo_1.default.adMediaType = UserInfo_1.PlatformIdType.adMedia_gdt;
            }
            FileUtils_1.default.initRootCachePath();
            //初始化引擎扩展
            EngineExpand_1.default.initEngineExpand();
            UserInfo_1.default.platform.setSystemInfo();
            new MainModule_1.default();
        };
        this.showMainModule();
    }
    showMainModule() {
    }
    /**打点-激活数据上传到阿里云 */
    checkIsNew() {
    }
    //初始化全局变量
    initWindowEnv() {
        if (!window["LogsManager"]) {
            window["LogsManager"] = LogsManager_1.default;
        }
        if (!window["UserInfo"]) {
            window["UserInfo"] = UserInfo_1.default;
        }
        //赋值timemanager
        window["TimeManager"] = TimerManager_1.default;
        window["GlobalData"] = GlobalData_1.default;
    }
}
//激活启动类
new Main();
