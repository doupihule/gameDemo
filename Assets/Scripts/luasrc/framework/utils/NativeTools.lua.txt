require("framework/manager/LogsManager")

NativeTools = class('NativeTools')
function NativeTools.downLoadFile(url, callBack, thisObj, isBin, progressFunc)
  if isBin == nil then
    isBin=false
  end
  if progressFunc == nil then
    progressFunc=nil
  end
  -- [ts2lua]window下标访问可能不正确
  local conFileCl = window["conch_File"]
  -- [ts2lua]window下标访问可能不正确
  local conFileReaderCl = window["conch_FileReader"]
  local f = conFileCl(url)
  local fr = conFileReaderCl()
  fr:setIgnoreError(true)
  fr.onload = function()
    callBack:call(thisObj, fr.result)
  end
  
  fr.onerror = function(e)
    LogsManager.warn('downLoadERROR ', e)
    callBack:call(thisObj, nil)
  end
  
  fr.onprogress = progressFunc
  if isBin then
    fr:readAsArrayBuffer(f)
  else
    fr:readAsText(f)
  end
end
