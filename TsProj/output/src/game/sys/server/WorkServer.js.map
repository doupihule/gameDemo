{"version":3,"file":"WorkServer.js","sourceRoot":"","sources":["../../../../../src/game/sys/server/WorkServer.ts"],"names":[],"mappings":";;AAAA,oEAA6D;AAC7D,qFAA8E;AAC9E,kDAA2C;AAC3C,wDAAiD;AACjD,6CAAsC;AAGtC,kDAA2C;AAC3C,+CAAwC;AACxC,oEAA6D;AAC7D,wEAAiE;AACjE,sEAA+D;AAC/D,4EAAqE;AACrE,yEAAkE;AAGlE;;GAEG;AACH,MAAqB,UAAU;IAC3B,QAAQ;IACR,MAAM,CAAC,cAAc,CAAC,IAAI,EAAE,QAAQ,GAAG,IAAI,EAAE,OAAO,GAAG,IAAI;QACvD,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,MAAM,GAAG,EAAE,CAAA;QACf,IAAI,IAAI,GAAG,EAAE,CAAA;QACb,IAAI,QAAQ,GAAG,mBAAS,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC;QAChD,qBAAqB;QACrB,KAAK,IAAI,EAAE,IAAI,QAAQ,EAAE;YACrB,IAAI,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,EAAE;gBACrB,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;gBACf,OAAO,QAAQ,CAAC,EAAE,CAAC,CAAA;aACtB;iBAAM;gBACH,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE;oBAClB,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;oBACf,OAAO,QAAQ,CAAC,EAAE,CAAC,CAAA;iBACtB;aACJ;SACJ;QAED,IAAI,OAAO,GAAG,EAAE,CAAC;QACjB,IAAI,YAAY,GAAG,mBAAS,CAAC,QAAQ,CAAC,eAAe,EAAE,CAAC;QACxD,IAAI,OAAO,GAAG,kBAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,eAAe,EAAE,YAAY,CAAC,CAAC;QAC3E,IAAI,KAAK,GAAG,OAAO,CAAC,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;QAC3D,IAAI,KAAK,IAAI,CAAC,EAAE;YACZ,uBAAa,CAAC,OAAO,CAAC,uBAAa,CAAC,QAAQ,CAAC,YAAY,CAAC,uBAAuB,CAAC,CAAC,CAAA;SACtF;QACD,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,IAAI,SAAS,GAAG,OAAO,CAAC,QAAQ,CAAC;YACjC,MAAM;YACN,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACvC,IAAI,UAAU,GAAG,EAAE,CAAC;gBACpB,IAAI,MAAM,CAAC;gBACX,IAAI,OAAO,GAAG,KAAK,CAAC;gBACpB,KAAK,IAAI,GAAG,IAAI,QAAQ,EAAE;oBACtB,+BAA+B;oBAC/B,IAAI,QAAQ,CAAC,GAAG,CAAC,CAAC,KAAK,IAAI,QAAQ,CAAC,GAAG,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE;wBACvD,OAAO,GAAG,IAAI,CAAC;wBACf,MAAM;qBACT;iBACJ;gBACD,IAAI,OAAO;oBAAE,SAAS;gBACtB,oBAAU,CAAC,QAAQ,CAAC,kBAAQ,CAAC,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,EAAE,UAAU,CAAC,CAAA;gBAC1G,KAAK,IAAI,CAAC,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;oBAC7C,MAAM,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC1B,IAAI,OAAO,CAAC,MAAM,CAAC,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE;wBACrC,UAAU,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;qBAC3B;iBACJ;gBACD,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;oBACvB,MAAM,GAAG,mBAAS,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;oBAChD,OAAO,CAAC,MAAM,CAAC,GAAG;wBACd,EAAE,EAAE,MAAM;wBACV,KAAK,EAAE,CAAC,GAAG,CAAC;qBACf,CAAA;oBACD,KAAK,IAAI,CAAC,CAAC;oBACX,IAAI,KAAK,IAAI,CAAC;wBAAE,MAAM;iBACzB;aACJ;SAEJ;QACD,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,IAAI,WAAW,GAAG,EAAE,CAAC;YACrB,oBAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;YACrD,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,KAAK,CAAC,CAAA;SACtE;QACD,UAAU;QACV,IAAI,SAAS,GAAG,kBAAQ,CAAC,QAAQ,CAAC,gBAAgB,EAAE,CAAC;QACrD,IAAI,CAAC,YAAY,CAAC,GAAG,SAAS,CAAC;QAC/B,IAAI,CAAC,UAAU,CAAC,GAAG,OAAO,CAAC;QAC3B,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAC;QACtB,MAAM,CAAC,MAAM,CAAC,GAAG;YACb,QAAQ,EAAE,MAAM;SACnB,CAAA;QACD,IAAI,QAAQ,GAAG,gBAAM,CAAC,QAAQ,CAAC,iBAAiB,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;QACvE,IAAI,QAAQ,EAAE;YACV,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;SACpC;QACD,4BAAkB,CAAC,mBAAmB,EAAE,CAAC;IAC7C,CAAC;IACD,MAAM,CAAC,eAAe,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,KAAK;QAChE,IAAI,UAAU,GAAG,mBAAS,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;QACtD,IAAI,UAAU,GAAG,EAAE,CAAC;QACpB,IAAI,YAAY,CAAC;QAEjB,oBAAU,CAAC,QAAQ,CAAC,kBAAQ,CAAC,QAAQ,CAAC,gBAAgB,CAAC,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,EAAE,UAAU,CAAC,CAAA;QAC3G,KAAK,IAAI,CAAC,GAAG,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;YAC7C,YAAY,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAChC,6BAA6B;YAC7B,IAAI,OAAO,CAAC,YAAY,CAAC,IAAI,QAAQ,CAAC,YAAY,CAAC,EAAE;gBACjD,UAAU,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;aAC3B;SACJ;QACD,qBAAqB;QACrB,IAAI,UAAU,CAAC,MAAM,IAAI,CAAC,EAAE;YACxB,IAAI,KAAK,GAAG,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,CAAA;YACpE,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SAChC;aAAM;YACH,YAAY,GAAG,mBAAS,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;YACtD,OAAO,CAAC,YAAY,CAAC,GAAG;gBACpB,EAAE,EAAE,YAAY;aACnB,CAAA;YACD,KAAK,IAAI,CAAC,CAAC;SACd;QACD,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,IAAI,WAAW,CAAC,MAAM,IAAI,CAAC,EAAE;gBACzB,qBAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,YAAY,CAAC,CAAA;gBAC1C,OAAM;aACT;YACD,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,KAAK,CAAC,CAAA;SACtE;IACL,CAAC;IACD,UAAU;IACV,MAAM,CAAC,WAAW,CAAC,IAAS,EAAE,WAAgB,IAAI,EAAE,UAAe,IAAI;QACnE,IAAI,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC;QACjB,IAAI,GAAG,GAAG,kBAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;QACpD,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC1C,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;SAClC;QACD,IAAI,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC;QACjB,QAAQ,CAAC,EAAE,CAAC,GAAG;YACX,EAAE,EAAE,gBAAM,CAAC,QAAQ,CAAC,UAAU,GAAG,EAAE;YACnC,OAAO,EAAE,EAAE;SACd,CAAA;QACD,IAAI,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAC;QAC5B,IAAI,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAC;QAC5B,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAA;QACrB,IAAI,QAAQ,GAAG,gBAAM,CAAC,QAAQ,CAAC,iBAAiB,CAAC,IAAI,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;QACrE,IAAI,QAAQ,EAAE;YACV,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;SACpC;QACD,4BAAkB,CAAC,mBAAmB,EAAE,CAAC;IAC7C,CAAC;IACD,UAAU;IACV,MAAM,CAAC,UAAU,CAAC,IAAS,EAAE,WAAgB,IAAI,EAAE,UAAe,IAAI;QAClE,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,IAAI,MAAM,GAAG,EAAE,CAAA;QACf,IAAI,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC7B,IAAI,QAAQ,EAAE;YACV,MAAM,CAAC,UAAU,CAAC,GAAG,qBAAW,CAAC,SAAS,CAAC,mBAAS,CAAC,QAAQ,CAAC,OAAO,EAAE,EAAE,QAAQ,CAAC,CAAC;SACtF;QACD,IAAI,GAAG,GAAG,kBAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;QACzD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC1C,IAAI,EAAE,GAAG,mBAAS,CAAC,QAAQ,CAAC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAA;YAC9D,IAAI,MAAM,CAAC,EAAE,CAAC,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE;gBAC/B,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAA;aAC9B;SACJ;QACD,MAAM,CAAC,MAAM,CAAC,GAAG;YACb,QAAQ,EAAE,MAAM;SACnB,CAAA;QACD,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG;YAChB,EAAE,EAAE,gBAAM,CAAC,QAAQ,CAAC,UAAU;SACjC,CAAA;QACD,IAAI,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAC;QAC5B,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAA;QACrB,IAAI,QAAQ,GAAG,gBAAM,CAAC,QAAQ,CAAC,iBAAiB,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;QACvE,IAAI,QAAQ,EAAE;YACV,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;SACpC;QACD,4BAAkB,CAAC,mBAAmB,EAAE,CAAC;IAC7C,CAAC;IACD,YAAY;IACZ,MAAM,CAAC,aAAa,CAAC,IAAS,EAAE,WAAgB,IAAI,EAAE,UAAe,IAAI;QACrE,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,IAAI,QAAQ,GAAG,EAAE,CAAC;QAClB,IAAI,MAAM,GAAG,EAAE,CAAA;QACf,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG;YAChB,MAAM,EAAE,CAAC;SACZ,CAAA;QACD,IAAI,MAAM,GAAG,iBAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,CAAC,UAAU,CAAC,CAAC;QAChF,IAAI,GAAG,GAAG,kBAAQ,CAAC,QAAQ,CAAC,WAAW,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC;QACzD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAC1C,IAAI,EAAE,GAAG,mBAAS,CAAC,QAAQ,CAAC,iBAAiB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAA;YAC9D,IAAI,MAAM,CAAC,EAAE,CAAC,IAAI,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE;gBAC/B,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAA;aAC9B;SACJ;QACD,MAAM,CAAC,MAAM,CAAC,GAAG;YACb,QAAQ,EAAE,MAAM;SACnB,CAAA;QACD,IAAI,MAAM,CAAC,MAAM,CAAC,EAAE;YAChB,MAAM,CAAC,MAAM,CAAC,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAA;SACxC;aAAM;YACH,IAAI,CAAC,UAAU,CAAC,GAAG,QAAQ,CAAC;YAC5B,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAA;SACxB;QAED,IAAI,QAAQ,GAAG,gBAAM,CAAC,QAAQ,CAAC,iBAAiB,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC;QACvE,IAAI,QAAQ,EAAE;YACV,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;SACpC;QACD,4BAAkB,CAAC,mBAAmB,EAAE,CAAC;IAE7C,CAAC;IACD,UAAU;IACV,MAAM,CAAC,aAAa,CAAC,IAAS,EAAE,WAAgB,IAAI,EAAE,UAAe,IAAI;QACrE,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,IAAI,IAAI,CAAC,IAAI,EAAE;YACX,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;SACpB;QACD,IAAI,MAAM,GAAG,iBAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;QACrD,IAAI,IAAI,GAAG,EAAE,CAAC;QACd,IAAI,GAAG;YACH,YAAY,EAAE,mBAAS,CAAC,QAAQ,CAAC,eAAe,EAAE,GAAG,CAAC;SACzD,CAAA;QACD,MAAM,CAAC,MAAM,CAAC,GAAG,IAAI,CAAA;QACrB,IAAI,QAAQ,GAAG,gBAAM,CAAC,QAAQ,CAAC,iBAAiB,CAAC,IAAI,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;QACrE,IAAI,QAAQ,EAAE;YACV,QAAQ,CAAC,IAAI,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;SACpC;QACD,4BAAkB,CAAC,mBAAmB,EAAE,CAAC;IAE7C,CAAC;CAEJ;AAhOD,6BAgOC"}